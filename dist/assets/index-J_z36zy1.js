const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DI0TgF9M.js","assets/react-vendor-CfGu_lG-.js","assets/VoidedInvoicesModal-BxKKm5hh.js","assets/icons-C1PWaf9n.js","assets/MonthlySales-Cr7JcAL1.js","assets/ProductosLayout-DCkBE96T.js","assets/AnalyticsLayout-C1mY0v4p.js","assets/UnifiedInventoryAnalysis-CmjeaJiy.js","assets/directApiService-D9-M1_bd.js","assets/DirectStatsDashboard-IRfGMCdC.js","assets/DirectSalesTotals-DOYdGHw9.js","assets/DirectSalesDocuments-Blu6PcTw.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,a,N as r,g as n,R as o,u as l,b as i,B as c,c as d,d as m}from"./react-vendor-CfGu_lG-.js";import{A as x,R as u,E as h,a as p,L as g,S as b,b as f,H as j,c as y,C as v,D as w,T as N,d as S,e as E,F as _,B as C,P as k,f as D,U as T,Z as P,g as O,h as $}from"./icons-C1PWaf9n.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var A={exports:{}},I={},R=s,L=Symbol.for("react.element"),z=Symbol.for("react.fragment"),V=Object.prototype.hasOwnProperty,U=R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,s){var a,r={},n=null,o=null;for(a in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(o=t.ref),t)V.call(t,a)&&!F.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:L,type:e,key:n,ref:o,props:r,_owner:U.current}}I.Fragment=z,I.jsx=q,I.jsxs=q,A.exports=I;var W=A.exports,M={},B=a;M.createRoot=B.createRoot,M.hydrateRoot=B.hydrateRoot;const G={},J=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));a=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in G)return;G[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,s&&r.setAttribute("nonce",s),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},H=(e,t)=>{try{const s="string"==typeof t?t:JSON.stringify(t),a=btoa(unescape(encodeURIComponent(s)));sessionStorage.setItem(e,a)}catch(s){}},Y=e=>{try{const t=sessionStorage.getItem(e);if(!t)return null;const s=decodeURIComponent(escape(atob(t)));try{return JSON.parse(s)}catch{return s}}catch(t){return null}},K=e=>{try{sessionStorage.removeItem(e)}catch(t){}};const Z=new class{log(...e){}warn(...e){}error(...e){}info(...e){}debug(...e){}group(e){}groupEnd(){}table(e){}time(e){}timeEnd(e){}},Q=["http://10.28.168.57:5000","http://localhost:5000"],X="https://cierre-caja-api.onrender.com";let ee=null;const te=async(e,t,s)=>{const a=new AbortController,r=setTimeout(()=>a.abort(),s);try{const s=await fetch(e,{...t,signal:a.signal});return clearTimeout(r),s}catch(n){throw clearTimeout(r),n}},se=async(e,t={},s=null)=>{const a=Y("authToken"),r={...t.headers||{}};t.body instanceof FormData||(r["Content-Type"]="application/json"),a&&(r.Authorization=`Bearer ${a}`),void 0===r["Content-Type"]&&delete r["Content-Type"];const n={...t,headers:r};let o=null;const l=(()=>{const e=window.location.hostname;return!["onrender.com","netlify.app","vercel.app","github.io","herokuapp.com","railway.app","fly.dev"].some(t=>e.endsWith(t)||e.includes(t))&&("localhost"===e||"127.0.0.1"===e||e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.16.")||e.startsWith("172.17.")||e.startsWith("172.18.")||e.startsWith("172.19.")||e.startsWith("172.2")||e.startsWith("172.30.")||e.startsWith("172.31."))})();if(l?Z.info("Frontend en entorno LOCAL - Prioridad: backends locales"):Z.info("Frontend en entorno DESPLEGADO - Usando solo backend desplegado"),ee)if(l||ee===X)try{const t=Q.includes(ee),a=s||(t?15e3:8e4);if(o=await te(`${ee}${e}`,n,a),o.ok||401===o.status||403===o.status){if(401===o.status)throw K("authToken"),K("authUser"),window.location.href="/login",new Error("Sesi√≥n expirada. Por favor inicia sesi√≥n nuevamente.");if(403===o.status)throw window.location.href="/unauthorized",new Error("No tienes permisos para acceder a este recurso.");return o}}catch(i){Z.warn(`Error al conectar con ${ee}:`,i.message),ee=null}else ee=null;if(l){for(const t of Q)try{Z.info("Intentando conectar con backend local:",t);const a=s||15e3;if(o=await te(`${t}${e}`,n,a),ee=t,Z.info("Conectado exitosamente con backend local:",t),401===o.status)throw K("authToken"),K("authUser"),window.location.href="/login",new Error("Sesi√≥n expirada. Por favor inicia sesi√≥n nuevamente.");if(403===o.status)throw window.location.href="/unauthorized",new Error("No tienes permisos para acceder a este recurso.");return o}catch(c){Z.warn(`Backend local ${t} no disponible`)}Z.warn("Backends locales no disponibles, intentando con backend desplegado como fallback...")}try{Z.info("Conectando con backend desplegado:",X);const t=s||3e4;if(o=await te(`${X}${e}`,n,t),ee=X,Z.info("Conectado exitosamente con backend desplegado"),401===o.status)throw K("authToken"),K("authUser"),window.location.href="/login",new Error("Sesi√≥n expirada. Por favor inicia sesi√≥n nuevamente.");if(403===o.status)throw window.location.href="/unauthorized",new Error("No tienes permisos para acceder a este recurso.");return o}catch(d){const e=l?{locales:Q.join(", "),deployed:X,lastError:d.message}:{deployed:X,lastError:d.message};throw Z.error("Error de conexi√≥n:",e),new Error("No se pudo conectar con el servidor. Por favor verifica tu conexi√≥n a internet.")}},ae=async e=>{const t=await se("/api/sum_payments",{method:"POST",body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.message||"Error al procesar el cierre de caja")}return await t.json()},re=s.createContext(null),ne=({children:e})=>{const[t,a]=s.useState(null),[r,n]=s.useState(null),[o,l]=s.useState(!0),[i,c]=s.useState(0),[d,m]=s.useState(null);s.useEffect(()=>{const e=Y("authToken"),t=Y("authUser");if(e&&t)try{const s="string"==typeof t?JSON.parse(t):t;if(s.loginTime){const t=new Date(s.loginTime).getTime();Date.now()-t>288e5?(Z.warn("Sesi√≥n expirada"),x()):(n(e),a(s))}}catch(s){Z.error("Error al restaurar sesi√≥n:",s),x()}l(!1)},[]);const x=()=>{K("authToken"),K("authUser"),n(null),a(null)},u={user:t,token:r,login:async(e,t)=>{if(d&&(Date.now()<d||(m(null),c(0),0))){return{success:!1,error:`Cuenta bloqueada. Intenta nuevamente en ${Math.ceil((d-Date.now())/1e3/60)} minutos.`}}if(!e||!t)return{success:!1,error:"Email y contrase√±a son requeridos"};if(!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(e))return{success:!1,error:"Formato de email inv√°lido"};if(t.length<8)return{success:!1,error:"La contrase√±a debe tener al menos 8 caracteres"};try{const s=await se("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})}),r=await s.json();if(!s.ok){const e=i+1;if(c(e),e>=5){const e=Date.now()+9e5;return m(e),Z.warn("Cuenta bloqueada despu√©s de 5 intentos fallidos"),{success:!1,error:"Demasiados intentos fallidos. Cuenta bloqueada por 15 minutos."}}return Z.warn(`Intento de login fallido (${e}/5)`),{success:!1,error:r.message||`Credenciales incorrectas (${e}/5 intentos)`}}c(0),m(null);const o=r.token,l={email:r.user.email,name:r.user.name,role:r.user.role,loginTime:(new Date).toISOString()};return H("authToken",o),H("authUser",l),n(o),a(l),Z.info("Login exitoso para:",e),{success:!0}}catch(s){return Z.error("Error en login:",s.message),{success:!1,error:"Error al conectar con el servidor. Por favor intente nuevamente."}}},logout:x,isAuthenticated:()=>!!r&&!!t,loading:o};return W.jsx(re.Provider,{value:u,children:e})},oe=()=>{const e=s.useContext(re);if(!e)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return e},le=e=>{if(!e||0===e.length)return!0;const t=(()=>{const e=ie();return(null==e?void 0:e.role)||null})();return t&&e.includes(t)},ie=()=>{const e=Y("authUser");if(!e)return null;try{return"string"==typeof e?JSON.parse(e):e}catch(t){return null}},ce=({children:e,allowedRoles:t})=>{const{isAuthenticated:s,loading:a}=oe();return a?W.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),W.jsx("p",{className:"text-gray-600 font-medium",children:"Verificando sesi√≥n..."})]})}):s()?t&&!le(t)?W.jsx(r,{to:"/unauthorized",replace:!0}):e:W.jsx(r,{to:"/login",replace:!0})};var de={exports:{}};function me(){}function xe(){}xe.resetWarningCache=me;de.exports=function(){function e(e,t,s,a,r,n){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:xe,resetWarningCache:me};return s.PropTypes=s,s}();const ue=n(de.exports);class he extends o.Component{constructor(e){super(e),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){Z.error("Error capturado por Error Boundary:",e,t),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:W.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:W.jsx("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:W.jsxs("div",{className:"flex flex-col items-center text-center",children:[W.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:W.jsx(x,{className:"w-10 h-10 text-red-600"})}),W.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"¬°Ups! Algo sali√≥ mal"}),W.jsx("p",{className:"text-gray-600 mb-6",children:"Lo sentimos, ha ocurrido un error inesperado. Por favor, intenta nuevamente."}),!1,W.jsxs("button",{onClick:this.handleReset,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg",children:[W.jsx(u,{className:"w-5 h-5"}),"Reintentar"]}),W.jsxs("p",{className:"mt-4 text-sm text-gray-500",children:["Si el problema persiste,"," ",W.jsx("a",{href:"mailto:soporte@koaj.com",className:"text-blue-600 hover:underline",children:"contacta a soporte"})]})]})})}):this.props.children}}he.propTypes={children:ue.node.isRequired,fallback:ue.node};const pe=e=>{s.useEffect(()=>{const t="Sistema de Cierre Puerto Carre√±o",s=e?`${e} - ${t}`:t;return document.title=s,()=>{document.title=t}},[e])},ge=()=>{const[e,t]=s.useState(""),[a,r]=s.useState(""),[n,o]=s.useState(""),[i,c]=s.useState(!1),[d,m]=s.useState(!1),{login:u}=oe(),b=l();pe("Iniciar Sesi√≥n");return W.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:W.jsx("div",{className:"max-w-md w-full",children:W.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[W.jsxs("div",{className:"text-center mb-8",children:[W.jsx("div",{className:"inline-flex items-center justify-center mb-3",children:W.jsx("div",{className:"bg-gray-900 rounded-2xl p-3 shadow-lg",children:W.jsx("div",{className:"text-white text-xl font-bold tracking-widest",style:{fontFamily:"Arial, sans-serif",letterSpacing:"0.3em"},children:"KOAJ"})})}),W.jsx("div",{className:"mb-3",children:W.jsx("p",{className:"text-lg font-semibold text-blue-600",children:"Puerto Carre√±o"})}),W.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sistema de Cierre de Caja y Arqueo Diario"}),W.jsx("p",{className:"text-gray-600",children:"Inicia sesi√≥n para acceder al sistema"})]}),n&&W.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[W.jsx(x,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),W.jsx("p",{className:"text-sm text-red-800",children:n})]}),W.jsxs("form",{onSubmit:async t=>{t.preventDefault(),o(""),c(!0);try{const t=await u(e,a);t.success?b("/"):o(t.error||"Error al iniciar sesi√≥n")}catch(s){o("Error al iniciar sesi√≥n. Por favor intenta de nuevo.")}finally{c(!1)}},className:"space-y-6",children:[W.jsxs("div",{children:[W.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electr√≥nico"}),W.jsx("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none",placeholder:"usuario@ejemplo.com",disabled:i})]}),W.jsxs("div",{children:[W.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrase√±a"}),W.jsxs("div",{className:"relative",children:[W.jsx("input",{id:"password",type:d?"text":"password",value:a,onChange:e=>r(e.target.value),required:!0,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",disabled:i}),W.jsx("button",{type:"button",onClick:()=>m(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",disabled:i,tabIndex:-1,children:d?W.jsx(h,{className:"w-5 h-5"}):W.jsx(p,{className:"w-5 h-5"})})]})]}),W.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?W.jsxs(W.Fragment,{children:[W.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Iniciando sesi√≥n..."]}):W.jsxs(W.Fragment,{children:[W.jsx(g,{className:"w-5 h-5"}),"Iniciar sesi√≥n"]})})]}),W.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:W.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Sistema de Gesti√≥n de Cierre de Caja v5.0"})})]})})})},be=()=>{const e=l(),t=ie();return pe("Acceso Denegado"),W.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 flex items-center justify-center p-4",children:W.jsx("div",{className:"max-w-md w-full",children:W.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[W.jsx("div",{className:"flex justify-center mb-6",children:W.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:W.jsx(b,{className:"w-12 h-12 text-red-600"})})}),W.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-3",children:"Acceso Denegado"}),W.jsx("p",{className:"text-gray-600 text-center mb-2",children:"No tienes permisos para acceder a esta secci√≥n del sistema."}),t&&W.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[W.jsxs("p",{className:"text-sm text-gray-700 text-center",children:[W.jsx("span",{className:"font-medium",children:"Usuario:"})," ",t.name||t.email]}),W.jsxs("p",{className:"text-sm text-gray-700 text-center mt-1",children:[W.jsx("span",{className:"font-medium",children:"Rol:"})," ",W.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"admin"===t.role?"Administrador":"sales"===t.role?"Ventas":t.role})]})]}),W.jsx("p",{className:"text-sm text-gray-500 text-center mb-6",children:"Si crees que esto es un error, contacta al administrador del sistema."}),W.jsxs("div",{className:"space-y-3",children:[W.jsxs("button",{onClick:()=>e(-1),className:"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[W.jsx(f,{className:"w-5 h-5"}),"Volver Atr√°s"]}),W.jsxs("button",{onClick:()=>e("/dashboard"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[W.jsx(j,{className:"w-5 h-5"}),"Ir al Dashboard"]})]}),W.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:W.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Sistema de Gesti√≥n de Cierre de Caja"})})]})})})},fe=()=>{const e=(new Date).toLocaleString("en-US",{timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return new Date(e)},je=()=>{const e=fe();return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},ye=()=>{const e=fe();return`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`},ve=()=>{const e=fe();return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}-05:00`},we=e=>{const[t,s,a]=e.split("-").map(Number);return new Date(t,s-1,a).toLocaleDateString("es-CO",{day:"2-digit",month:"long",year:"numeric"})},Ne=({date:e})=>{const[t,a]=s.useState(!0),[r,n]=s.useState(null),[o,l]=s.useState(null);if(s.useEffect(()=>{(async()=>{try{a(!0),n(null),Z.info("Obteniendo comparaci√≥n a√±o sobre a√±o para:",e);const t=await(async(e=null)=>{const t=e?`/api/sales_comparison_yoy?date=${e}`:"/api/sales_comparison_yoy",s=await se(t,{method:"GET"},6e4);if(!s.ok){const e=await s.json().catch(()=>({}));throw new Error(e.error||"Error al obtener comparaci√≥n de ventas")}return await s.json()})(e);if(!t.success)throw new Error(t.error||"Error al obtener datos de comparaci√≥n");l(t),Z.info("Datos de comparaci√≥n obtenidos exitosamente")}catch(t){Z.error("Error al obtener comparaci√≥n:",t),n(t.message)}finally{a(!1)}})()},[e]),t)return W.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 sm:p-6 border-2 border-blue-200",children:W.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600",children:[W.jsx(y,{className:"w-5 h-5 animate-spin"}),W.jsx("span",{className:"text-sm font-medium",children:"Cargando comparaci√≥n a√±o anterior..."})]})});if(r)return W.jsx("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 rounded-xl p-4 border-2 border-red-200",children:W.jsxs("div",{className:"flex items-center gap-2 text-red-600",children:[W.jsx(x,{className:"w-5 h-5"}),W.jsxs("span",{className:"text-sm font-medium",children:["Error al cargar comparaci√≥n: ",r]})]})});if(!o)return null;const{daily_comparison:i,monthly_comparison:c}=o,d=({title:e,icon:t,current:s,previous:a,comparison:r,periodLabel:n})=>{const o=r.is_growth,l=o?N:S,i=o?"text-green-600":"text-red-600",c=o?"bg-green-100":"bg-red-100",d=o?"border-green-300":"border-red-300";return W.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-gray-200 shadow-sm",children:[W.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-gray-200",children:[W.jsx(t,{className:"w-4 h-4 text-blue-600"}),W.jsx("h4",{className:"text-sm font-bold text-gray-700",children:e})]}),W.jsxs("div",{className:"space-y-2 mb-3",children:[W.jsxs("div",{className:"flex justify-between items-center",children:[W.jsxs("span",{className:"text-xs text-gray-600",children:[n,":"]}),W.jsx("span",{className:"text-base font-bold text-gray-900",children:s.formatted})]}),W.jsxs("div",{className:"flex justify-between items-center",children:[W.jsx("span",{className:"text-xs text-gray-500",children:"A√±o anterior:"}),W.jsx("span",{className:"text-sm font-semibold text-gray-600",children:a.formatted})]})]}),W.jsxs("div",{className:`${c} ${d} border rounded-lg p-2.5`,children:[W.jsxs("div",{className:"flex items-center justify-between gap-2",children:[W.jsxs("div",{className:"flex items-center gap-1.5",children:[W.jsx(l,{className:`w-4 h-4 ${i}`}),W.jsx("span",{className:`text-xs font-semibold ${i}`,children:r.growth_label.toUpperCase()})]}),W.jsxs("span",{className:`text-sm font-bold ${i}`,children:[o?"+":"",r.percentage_change,"%"]})]}),W.jsxs("div",{className:"mt-1.5 text-xs text-gray-700 font-medium",children:["Diferencia: ",o?"+":"-"," ",r.difference_formatted]})]})]})};return W.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 sm:p-6 border-2 border-amber-200 mb-4 sm:mb-6",children:[W.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-amber-900 mb-4 flex items-center gap-2",children:[W.jsx("span",{className:"w-1.5 h-6 bg-amber-600 rounded"}),"Comparaci√≥n con A√±o Anterior"]}),W.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[W.jsx(d,{title:"Ventas del D√≠a",icon:v,current:i.current,previous:i.previous_year,comparison:i.comparison,periodLabel:`Hoy (${i.current.date})`}),W.jsx(d,{title:"Ventas del Mes",icon:w,current:c.current,previous:c.previous_year,comparison:c.comparison,periodLabel:"Mes actual"})]}),W.jsxs("div",{className:"mt-3 text-xs text-amber-700 bg-amber-100 rounded-lg p-2 border border-amber-300",children:[W.jsx("strong",{children:"Nota:"})," Comparaci√≥n con el mismo d√≠a y mes del a√±o ",i.previous_year.date.split("-")[0]]})]})},Se=({children:e})=>{const t=l(),a=i(),{user:r,logout:n}=oe(),[o,c]=s.useState(ye()),{dailySales:d,monthlySales:m,loading:x}=(()=>{const[e,t]=s.useState({dailySales:null,monthlySales:null,loading:!0,error:null}),a=async()=>{try{const e=je(),s=fe(),a=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-01`;Z.info("üìä Obteniendo estad√≠sticas de ventas (quick-summary)",{today:e,startDate:a});const r=3e4,[n,o]=await Promise.all([se(`/api/sales/quick-summary?from=${e}&to=${e}`,{method:"GET"},r).then(async e=>e.ok?await e.json():(await e.json().catch(()=>({})),null)).catch(e=>null),se(`/api/sales/quick-summary?from=${a}&to=${e}`,{method:"GET"},r).then(async e=>e.ok?await e.json():(await e.json().catch(()=>({})),null)).catch(e=>null)]),l=(null==n?void 0:n.total_sales)||0,i=(null==o?void 0:o.total_sales)||0;t({dailySales:l,monthlySales:i,loading:!1,error:null}),Z.info("‚úÖ Estad√≠sticas de ventas actualizadas",{dailySales:l,monthlySales:i})}catch(e){Z.error("Error al obtener estad√≠sticas de ventas",e),t(t=>({...t,loading:!1,error:e.message}))}};return s.useEffect(()=>{a();const e=setInterval(()=>{a()},3e5);return()=>clearInterval(e)},[]),e})(),u=e=>null==e?"Cargando...":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);s.useEffect(()=>{const e=setInterval(()=>{c(ye())},1e3);return()=>clearInterval(e)},[]);const[h,p]=s.useState(null),g=e=>{p(h===e?null:e)},b=[{id:"ventas-totales",label:"Totales de Ventas",path:"/estadisticas-avanzadas/ventas-totales",icon:N,color:"purple",roles:["admin"]},{id:"documentos-venta",label:"Documentos de Venta",path:"/estadisticas-avanzadas/documentos",icon:_,color:"blue",roles:["admin"]}],f=[{id:"analytics",label:"Analytics",path:"/estadisticas-estandar/analytics",icon:C,color:"orange",roles:["admin"]},{id:"inventario",label:"Inventario",path:"/estadisticas-estandar/inventario",icon:k,color:"teal",roles:["admin"]},{id:"productos",label:"Productos",path:"/estadisticas-estandar/productos",icon:E,color:"green",roles:["admin"]}],y=[{id:"dashboard",label:"Cierre de Caja",path:"/dashboard",icon:j,color:"blue",roles:["admin","sales"]},{id:"monthly-sales",label:"Ventas Mensuales",path:"/monthly-sales",icon:E,color:"purple",roles:["sales"]}].filter(e=>le(e.roles));b.filter(e=>le(e.roles)),f.filter(e=>le(e.roles));const S=e=>{t(e)},A=e=>({blue:"hover:bg-blue-50 hover:text-blue-700",purple:"hover:bg-purple-50 hover:text-purple-700",green:"hover:bg-green-50 hover:text-green-700",orange:"hover:bg-orange-50 hover:text-orange-700",teal:"hover:bg-teal-50 hover:text-teal-700"}[e]||"hover:bg-gray-50 hover:text-gray-700");return W.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex flex-col",children:[W.jsx("header",{className:"bg-white shadow-lg border-b-4 border-gradient-to-r from-blue-500 to-purple-500 sticky top-0 z-50",children:W.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[W.jsx("div",{className:"py-4 border-b border-gray-200",children:W.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4",children:[W.jsxs("div",{className:"flex items-center gap-3",children:[W.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center shadow-md",children:W.jsx(C,{className:"w-6 h-6 text-white"})}),W.jsxs("div",{children:[W.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Sistema de Gesti√≥n Koaj Puerto Carre√±o"}),W.jsx("p",{className:"text-xs text-gray-500",children:"Panel de Control"})]})]}),W.jsxs("div",{className:"flex items-center gap-4",children:[W.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-green-50 to-emerald-50 px-4 py-2 rounded-lg border border-green-200",children:[W.jsx(w,{className:"w-5 h-5 text-green-600"}),W.jsxs("div",{children:[W.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Venta del D√≠a"}),x?W.jsx("p",{className:"text-sm font-bold text-green-700 animate-pulse",children:"Cargando..."}):W.jsx("p",{className:"text-base font-bold text-green-700",children:u(d)})]})]}),W.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-blue-50 to-purple-50 px-4 py-2 rounded-lg border border-blue-200",children:[W.jsx(v,{className:"w-5 h-5 text-blue-600"}),W.jsxs("div",{children:[W.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Venta del Mes"}),x?W.jsx("p",{className:"text-sm font-bold text-blue-700 animate-pulse",children:"Cargando..."}):W.jsx("p",{className:"text-base font-bold text-blue-700",children:u(m)})]})]})]}),W.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[W.jsxs("div",{className:"text-right",children:[W.jsx("p",{className:"text-xs text-gray-500",children:"Usuario"}),W.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(null==r?void 0:r.name)||(null==r?void 0:r.email)||"Administrador"}),(null==r?void 0:r.role)&&W.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 mt-1",children:"admin"===r.role?"Administrador":"sales"===r.role?"Ventas":r.role}),W.jsxs("button",{onClick:()=>{n(),t("/login")},className:"mt-1 flex items-center gap-2 text-xs text-red-600 hover:text-red-700 font-medium transition-colors",children:[W.jsx(D,{className:"w-3 h-3"}),"Cerrar Sesi√≥n"]})]}),W.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center shadow-md",children:W.jsx(T,{className:"w-5 h-5 text-white"})})]})]})}),W.jsx("nav",{className:"py-3",children:W.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[y.map(e=>{const t=e.icon,s=(r=e.path,a.pathname===r||a.pathname.startsWith(r+"/"));var r,n;return W.jsxs("button",{onClick:()=>S(e.path),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium whitespace-nowrap transition-all duration-200 "+(s?`${n=e.color,{blue:"bg-blue-600 text-white",purple:"bg-purple-600 text-white",green:"bg-green-600 text-white",orange:"bg-orange-600 text-white",teal:"bg-teal-600 text-white"}[n]||"bg-gray-600 text-white"} shadow-md transform scale-105`:`text-gray-700 ${A(e.color)} border border-gray-200`),children:[W.jsx(t,{className:"w-4 h-4 "+(s?"text-white":"")}),W.jsx("span",{className:"text-sm",children:e.label})]},e.id)}),le(["admin"])&&W.jsxs("div",{className:"relative",children:[W.jsxs("button",{onClick:()=>g("advanced"),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium whitespace-nowrap transition-all duration-200 "+("advanced"===h?"bg-yellow-500 text-white shadow-md":"text-gray-700 hover:bg-yellow-50 hover:text-yellow-700 border border-gray-200"),children:[W.jsx(P,{className:"w-4 h-4 "+("advanced"===h?"text-white":"")}),W.jsx("span",{className:"text-sm",children:"‚ö° Estad√≠sticas Avanzadas"}),W.jsx(O,{className:"w-4 h-4 transition-transform "+("advanced"===h?"rotate-180":"")})]}),"advanced"===h&&W.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 z-[9999] min-w-[280px]",children:W.jsxs("div",{className:"py-2",children:[W.jsxs("button",{onClick:()=>{S("/estadisticas-avanzadas/ventas-totales"),g("advanced")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[W.jsx(N,{className:"w-5 h-5 text-purple-600"}),W.jsxs("div",{children:[W.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Totales de Ventas"}),W.jsx("div",{className:"text-xs text-gray-500",children:"Ventas agrupadas por d√≠a/mes"})]})]}),W.jsxs("button",{onClick:()=>{S("/estadisticas-avanzadas/documentos"),g("advanced")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[W.jsx(_,{className:"w-5 h-5 text-blue-600"}),W.jsxs("div",{children:[W.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Documentos de Venta"}),W.jsx("div",{className:"text-xs text-gray-500",children:"Facturas detalladas"})]})]})]})})]}),le(["admin"])&&W.jsxs("div",{className:"relative",children:[W.jsxs("button",{onClick:()=>g("standard"),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium whitespace-nowrap transition-all duration-200 "+("standard"===h?"bg-blue-500 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-700 border border-gray-200"),children:[W.jsx(C,{className:"w-4 h-4 "+("standard"===h?"text-white":"")}),W.jsx("span",{className:"text-sm",children:"üìä Estad√≠sticas Est√°ndar"}),W.jsx(O,{className:"w-4 h-4 transition-transform "+("standard"===h?"rotate-180":"")})]}),"standard"===h&&W.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 z-[9999] min-w-[280px]",children:W.jsxs("div",{className:"py-2",children:[W.jsxs("button",{onClick:()=>{S("/estadisticas-estandar/analytics"),g("standard")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[W.jsx(N,{className:"w-5 h-5 text-orange-600"}),W.jsxs("div",{children:[W.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Analytics Avanzado"}),W.jsx("div",{className:"text-xs text-gray-500",children:"An√°lisis inteligente de ventas"})]})]}),W.jsxs("button",{onClick:()=>{S("/estadisticas-estandar/productos"),g("standard")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[W.jsx(k,{className:"w-5 h-5 text-green-600"}),W.jsxs("div",{children:[W.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"An√°lisis de Productos"}),W.jsx("div",{className:"text-xs text-gray-500",children:"Reportes desde Alegra"})]})]}),W.jsxs("button",{onClick:()=>{S("/estadisticas-estandar/inventario"),g("standard")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[W.jsx(C,{className:"w-5 h-5 text-teal-600"}),W.jsxs("div",{children:[W.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"An√°lisis de Inventario"}),W.jsx("div",{className:"text-xs text-gray-500",children:"Estado del inventario"})]})]}),W.jsxs("button",{onClick:()=>{S("/monthly-sales"),g("standard")},className:"w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[W.jsx(E,{className:"w-5 h-5 text-purple-600"}),W.jsxs("div",{children:[W.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Ventas Mensuales"}),W.jsx("div",{className:"text-xs text-gray-500",children:"Reporte mensual"})]})]})]})})]})]})})]})}),W.jsx("div",{className:"py-4",children:W.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[W.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl shadow-lg p-4",children:W.jsx("div",{className:"flex items-center justify-center",children:W.jsxs("div",{className:"flex items-center gap-2 text-white",children:[W.jsx($,{className:"w-5 h-5 text-white"}),W.jsxs("div",{children:[W.jsx("p",{className:"text-sm font-semibold",children:o}),W.jsx("p",{className:"text-xs text-white opacity-90",children:"Hora de Colombia (UTC-5)"})]})]})})}),W.jsx("div",{className:"mt-6",children:W.jsx(Ne,{date:je()})})]})}),W.jsx("main",{className:"flex-1",children:W.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e})}),W.jsx("footer",{className:"bg-white border-t border-gray-200 mt-auto",children:W.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:W.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2",children:[W.jsxs("p",{className:"text-sm text-gray-600",children:["¬© ",(new Date).getFullYear()," Sistema de Gesti√≥n. Todos los derechos reservados."]}),W.jsx("p",{className:"text-xs text-gray-500",children:"Versi√≥n 2.0 | Desarrollado con ‚ù§Ô∏è"})]})})})]})},Ee=s.lazy(()=>J(()=>import("./Dashboard-DI0TgF9M.js").then(e=>e.D),__vite__mapDeps([0,1,2,3]))),_e=s.lazy(()=>J(()=>import("./MonthlySales-Cr7JcAL1.js"),__vite__mapDeps([4,1,2,3]))),Ce=s.lazy(()=>J(()=>import("./ProductosLayout-DCkBE96T.js"),__vite__mapDeps([5,1,3]))),ke=s.lazy(()=>J(()=>import("./AnalyticsLayout-C1mY0v4p.js"),__vite__mapDeps([6,1,3]))),De=s.lazy(()=>J(()=>import("./UnifiedInventoryAnalysis-CmjeaJiy.js"),__vite__mapDeps([7,1,8,3]))),Te=s.lazy(()=>J(()=>import("./DirectStatsDashboard-IRfGMCdC.js"),__vite__mapDeps([9,1,8,3,10,11]))),Pe=s.lazy(()=>J(()=>import("./DirectSalesTotals-DOYdGHw9.js"),__vite__mapDeps([10,1,8,3]))),Oe=s.lazy(()=>J(()=>import("./DirectSalesDocuments-Blu6PcTw.js"),__vite__mapDeps([11,1,8,3]))),$e=()=>W.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),W.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando..."})]})}),Ae=()=>W.jsx(he,{children:W.jsx(ne,{children:W.jsx(c,{children:W.jsx(s.Suspense,{fallback:W.jsx($e,{}),children:W.jsxs(d,{children:[W.jsx(m,{path:"/login",element:W.jsx(ge,{})}),W.jsx(m,{path:"/unauthorized",element:W.jsx(be,{})}),W.jsx(m,{path:"/dashboard",element:W.jsx(ce,{allowedRoles:["admin","sales"],children:W.jsx(Se,{children:W.jsx(Ee,{})})})}),W.jsx(m,{path:"/monthly-sales",element:W.jsx(ce,{allowedRoles:["admin","sales"],children:W.jsx(Se,{children:W.jsx(_e,{})})})}),W.jsx(m,{path:"/estadisticas-avanzadas",element:W.jsx(ce,{allowedRoles:["admin"],children:W.jsx(Se,{children:W.jsx(Te,{})})})}),W.jsx(m,{path:"/estadisticas-avanzadas/ventas-totales",element:W.jsx(ce,{allowedRoles:["admin"],children:W.jsx(Se,{children:W.jsx(Pe,{})})})}),W.jsx(m,{path:"/estadisticas-avanzadas/documentos",element:W.jsx(ce,{allowedRoles:["admin"],children:W.jsx(Se,{children:W.jsx(Oe,{})})})}),W.jsx(m,{path:"/estadisticas-estandar/productos",element:W.jsx(ce,{allowedRoles:["admin"],children:W.jsx(Se,{children:W.jsx(Ce,{})})})}),W.jsx(m,{path:"/estadisticas-estandar/analytics",element:W.jsx(ce,{allowedRoles:["admin"],children:W.jsx(Se,{children:W.jsx(ke,{})})})}),W.jsx(m,{path:"/estadisticas-estandar/inventario",element:W.jsx(ce,{allowedRoles:["admin"],children:W.jsx(Se,{children:W.jsx(De,{})})})}),W.jsx(m,{path:"/productos",element:W.jsx(r,{to:"/estadisticas-estandar/productos",replace:!0})}),W.jsx(m,{path:"/analytics",element:W.jsx(r,{to:"/estadisticas-estandar/analytics",replace:!0})}),W.jsx(m,{path:"/inventario",element:W.jsx(r,{to:"/estadisticas-estandar/inventario",replace:!0})}),W.jsx(m,{path:"/",element:W.jsx(r,{to:"/dashboard",replace:!0})}),W.jsx(m,{path:"*",element:W.jsx(r,{to:"/dashboard",replace:!0})})]})})})})});M.createRoot(document.getElementById("root")).render(W.jsx(o.StrictMode,{children:W.jsx(Ae,{})}));export{J as _,pe as a,ve as b,se as c,we as f,je as g,W as j,Z as l,ae as s,oe as u};
