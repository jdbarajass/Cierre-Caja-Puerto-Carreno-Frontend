const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-KXwYAqai.js","assets/react-vendor-CfGu_lG-.js","assets/VoidedInvoicesModal-BXR7aJZN.js","assets/icons-YGAATwQK.js","assets/MonthlySales-8yp_4yGK.js","assets/ProductosLayout-CjpXdKNc.js","assets/AnalyticsLayout-Y4qXQsCi.js","assets/UnifiedInventoryAnalysis-75KBNkG-.js","assets/directApiService-Bf6ZLS1J.js","assets/DirectStatsDashboard-Bx3Q6lW2.js","assets/DirectSalesTotals-5jHI5EeE.js","assets/DirectSalesDocuments-BK7JlquZ.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{r as a,a as s,N as r,g as n,R as o,u as l,b as i,B as d,c,d as m}from"./react-vendor-CfGu_lG-.js";import{A as u,R as x,E as h,a as p,L as g,S as f,b,H as j,c as y,T as v,F as w,B as N,P as S,C as E,d as $,e as k,f as _,U as D,g as C,D as T,h as O,i as P,j as I}from"./icons-YGAATwQK.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var A={exports:{}},L={},R=a,M=Symbol.for("react.element"),F=Symbol.for("react.fragment"),z=Object.prototype.hasOwnProperty,G=R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,q={key:!0,ref:!0,__self:!0,__source:!0};function U(e,t,a){var s,r={},n=null,o=null;for(s in void 0!==a&&(n=""+a),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(o=t.ref),t)z.call(t,s)&&!q.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:M,type:e,key:n,ref:o,props:r,_owner:G.current}}L.Fragment=F,L.jsx=U,L.jsxs=U,A.exports=L;var V=A.exports,Y={},B=s;Y.createRoot=B.createRoot,Y.hydrateRoot=B.hydrateRoot;const W={},J=function(e,t,a){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),a=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in W)return;W[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,a&&r.setAttribute("nonce",a),document.head.appendChild(r),t?new Promise((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},K=(e,t)=>{try{const a="string"==typeof t?t:JSON.stringify(t),s=btoa(unescape(encodeURIComponent(a)));sessionStorage.setItem(e,s)}catch(a){}},H=e=>{try{const t=sessionStorage.getItem(e);if(!t)return null;const a=decodeURIComponent(escape(atob(t)));try{return JSON.parse(a)}catch{return a}}catch(t){return null}},Z=e=>{try{sessionStorage.removeItem(e)}catch(t){}};const Q=new class{log(...e){}warn(...e){}error(...e){}info(...e){}debug(...e){}group(e){}groupEnd(){}table(e){}time(e){}timeEnd(e){}},X=["http://10.28.168.57:5000","http://localhost:5000"],ee="https://cierre-caja-api.onrender.com";let te=null;const ae=new Map;let se=new Set;const re=()=>{const e=window.location.hostname;if(["onrender.com","netlify.app","vercel.app","github.io","herokuapp.com","railway.app","fly.dev"].some(t=>e.endsWith(t)||e.includes(t)))return!1;return"localhost"===e||"127.0.0.1"===e||e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.16.")||e.startsWith("172.17.")||e.startsWith("172.18.")||e.startsWith("172.19.")||e.startsWith("172.2")||e.startsWith("172.30.")||e.startsWith("172.31.")},ne=async(e,t,a)=>{const s=new AbortController,r=setTimeout(()=>s.abort(),a);try{const a=await fetch(e,{...t,signal:s.signal});return clearTimeout(r),a}catch(n){throw clearTimeout(r),n}},oe=async(e,t={},a=null)=>{const s=H("authToken"),r={...t.headers||{}};t.body instanceof FormData||(r["Content-Type"]="application/json"),s&&(r.Authorization=`Bearer ${s}`),void 0===r["Content-Type"]&&delete r["Content-Type"];const n={...t,headers:r};let o=null;const l=re();if(l?Q.info("Frontend en entorno LOCAL - Prioridad: backends locales"):Q.info("Frontend en entorno DESPLEGADO - Usando solo backend desplegado"),te)if(l||te===ee)try{const t=X.includes(te),s=a||(t?15e3:8e4);if(o=await ne(`${te}${e}`,n,s),401===o.status)throw Z("authToken"),Z("authUser"),window.location.href="/login",new Error("Sesi√≥n expirada. Por favor inicia sesi√≥n nuevamente.");if(403===o.status)throw window.location.href="/unauthorized",new Error("No tienes permisos para acceder a este recurso.");return Q.info(`‚úÖ Usando backend configurado ${te} - No se intentar√° con otros backends`),o}catch(i){Q.warn(`Error de conexi√≥n con ${te}:`,i.message),X.includes(te)&&(se.clear(),ae.clear(),Q.info("üîÑ Backend configurado fall√≥ - Limpiando blacklist y contadores para reintentar")),te=null}else te=null;if(l){const t=X.filter(e=>!se.has(e));0===t.length?Q.warn("‚ö†Ô∏è Todos los backends locales est√°n en blacklist - Saltando a backend desplegado"):se.size>0&&Q.info(`‚ÑπÔ∏è Backends en blacklist (no se intentar√°n): ${Array.from(se).join(", ")}`);for(const s of t)try{const t=!te,r=a||(t?45e3:15e3);if(t?Q.info(`üîÑ Descubriendo backend local (timeout ${r/1e3}s):`,s):Q.info(`üîÑ Intentando conectar con backend local (timeout ${r/1e3}s):`,s),o=await ne(`${s}${e}`,n,r),ae.delete(s),te=s,Q.info(`‚úÖ Backend local configurado: ${s} - Peticiones futuras usar√°n este backend exclusivamente`),401===o.status)throw Z("authToken"),Z("authUser"),window.location.href="/login",new Error("Sesi√≥n expirada. Por favor inicia sesi√≥n nuevamente.");if(403===o.status)throw window.location.href="/unauthorized",new Error("No tienes permisos para acceder a este recurso.");return o}catch(d){const e=(ae.get(s)||0)+1;ae.set(s,e),e>=3?(se.add(s),Q.warn(`‚ùå Backend local ${s} fall√≥ ${e} veces - AGREGADO A BLACKLIST`)):Q.warn(`‚ö†Ô∏è Backend local ${s} fall√≥ (intento ${e}/3) - Reintentar√° en pr√≥xima petici√≥n`)}Q.warn("‚ö†Ô∏è TODOS los backends locales fallaron - Intentando con backend desplegado como √∫ltimo recurso")}try{Q.info("üåê Conectando con backend desplegado:",ee);const t=a||3e4;if(o=await ne(`${ee}${e}`,n,t),te=ee,Q.info("Conectado exitosamente con backend desplegado"),401===o.status)throw Z("authToken"),Z("authUser"),window.location.href="/login",new Error("Sesi√≥n expirada. Por favor inicia sesi√≥n nuevamente.");if(403===o.status)throw window.location.href="/unauthorized",new Error("No tienes permisos para acceder a este recurso.");return o}catch(c){const e=l?{locales:X.join(", "),deployed:ee,lastError:c.message}:{deployed:ee,lastError:c.message};throw Q.error("Error de conexi√≥n:",e),new Error("No se pudo conectar con el servidor. Por favor verifica tu conexi√≥n a internet.")}},le=async e=>{const t=await oe("/api/sum_payments",{method:"POST",body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.message||"Error al procesar el cierre de caja")}return await t.json()},ie=async e=>{const t=await oe(`/api/preconsulta?date=${e}`,{method:"GET"},6e4);if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(e.error||"Error al realizar la preconsulta")}return await t.json()},de=async(e=null)=>{const t=e?`/api/sales_comparison_yoy?date=${e}`:"/api/sales_comparison_yoy",a=await oe(t,{method:"GET"},6e4);if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(e.error||"Error al obtener comparaci√≥n de ventas")}return await a.json()},ce=a.createContext(null),me=({children:e})=>{const[t,s]=a.useState(null),[r,n]=a.useState(null),[o,l]=a.useState(!0),[i,d]=a.useState(0),[c,m]=a.useState(null);a.useEffect(()=>{const e=H("authToken"),t=H("authUser");if(e&&t)try{const a="string"==typeof t?JSON.parse(t):t;if(a.loginTime){const t=new Date(a.loginTime).getTime();Date.now()-t>288e5?(Q.warn("Sesi√≥n expirada"),u()):(n(e),s(a))}}catch(a){Q.error("Error al restaurar sesi√≥n:",a),u()}l(!1)},[]);const u=()=>{Z("authToken"),Z("authUser"),n(null),s(null)},x={user:t,token:r,login:async(e,t,a=null)=>{if(c&&(Date.now()<c||(m(null),d(0),0))){return{success:!1,error:`Cuenta bloqueada. Intenta nuevamente en ${Math.ceil((c-Date.now())/1e3/60)} minutos.`}}if(!e||!t)return{success:!1,error:"Email y contrase√±a son requeridos"};if(!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(e))return{success:!1,error:"Formato de email inv√°lido"};if(t.length<8)return{success:!1,error:"La contrase√±a debe tener al menos 8 caracteres"};const r=[3e3,5e3,8e3];for(let l=1;l<=4;l++)try{a&&l>1&&a({attempt:l,maxAttempts:4,message:`Reintentando conexi√≥n... (${l}/4)`}),Q.info(`Intento de login ${l}/4 para:`,e);const r=await oe("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})}),o=await r.json();if(!r.ok){if(400===r.status||401===r.status){const e=i+1;if(d(e),e>=5){const e=Date.now()+9e5;return m(e),Q.warn("Cuenta bloqueada despu√©s de 5 intentos fallidos"),{success:!1,error:"Demasiados intentos fallidos. Cuenta bloqueada por 15 minutos."}}return Q.warn(`Intento de login fallido (${e}/5)`),{success:!1,error:o.message||`Credenciales incorrectas (${e}/5 intentos)`}}throw new Error(o.message||"Error del servidor")}d(0),m(null);const c=o.token,u={email:o.user.email,name:o.user.name,role:o.user.role,loginTime:(new Date).toISOString()};return K("authToken",c),K("authUser",u),n(c),s(u),Q.info("Login exitoso para:",e),{success:!0}}catch(o){if(Q.error(`Error en intento ${l}/4:`,o.message),4===l)return{success:!1,error:"El servidor no responde. Por favor verifica tu conexi√≥n o intenta m√°s tarde."};const e=r[l-1];Q.info(`Esperando ${e}ms antes del pr√≥ximo intento...`),a&&a({attempt:l,maxAttempts:4,message:`Servidor iniciando... Reintentando en ${e/1e3}s`,isWaiting:!0}),await new Promise(t=>setTimeout(t,e))}return{success:!1,error:"Error al conectar con el servidor. Por favor intente nuevamente."}},logout:u,isAuthenticated:()=>!!r&&!!t,loading:o};return V.jsx(ce.Provider,{value:x,children:e})},ue=()=>{const e=a.useContext(ce);if(!e)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return e},xe=e=>{if(!e||0===e.length)return!0;const t=(()=>{const e=he();return(null==e?void 0:e.role)||null})();return t&&e.includes(t)},he=()=>{const e=H("authUser");if(!e)return null;try{return"string"==typeof e?JSON.parse(e):e}catch(t){return null}},pe=({children:e,allowedRoles:t})=>{const{isAuthenticated:a,loading:s}=ue();return s?V.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:V.jsxs("div",{className:"text-center",children:[V.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),V.jsx("p",{className:"text-gray-600 font-medium",children:"Verificando sesi√≥n..."})]})}):a()?t&&!xe(t)?V.jsx(r,{to:"/unauthorized",replace:!0}):e:V.jsx(r,{to:"/login",replace:!0})};var ge={exports:{}};function fe(){}function be(){}be.resetWarningCache=fe;ge.exports=function(){function e(e,t,a,s,r,n){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:be,resetWarningCache:fe};return a.PropTypes=a,a}();const je=n(ge.exports);class ye extends o.Component{constructor(e){super(e),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){Q.error("Error capturado por Error Boundary:",e,t),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:V.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:V.jsx("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:V.jsxs("div",{className:"flex flex-col items-center text-center",children:[V.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:V.jsx(u,{className:"w-10 h-10 text-red-600"})}),V.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"¬°Ups! Algo sali√≥ mal"}),V.jsx("p",{className:"text-gray-600 mb-6",children:"Lo sentimos, ha ocurrido un error inesperado. Por favor, intenta nuevamente."}),!1,V.jsxs("button",{onClick:this.handleReset,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg",children:[V.jsx(x,{className:"w-5 h-5"}),"Reintentar"]}),V.jsxs("p",{className:"mt-4 text-sm text-gray-500",children:["Si el problema persiste,"," ",V.jsx("a",{href:"mailto:soporte@koaj.com",className:"text-blue-600 hover:underline",children:"contacta a soporte"})]})]})})}):this.props.children}}ye.propTypes={children:je.node.isRequired,fallback:je.node};const ve=e=>{a.useEffect(()=>{const t="Sistema de Cierre Puerto Carre√±o",a=e?`${e} - ${t}`:t;return document.title=a,()=>{document.title=t}},[e])},we=()=>{const[e,t]=a.useState(""),[s,r]=a.useState(""),[n,o]=a.useState(""),[i,d]=a.useState(!1),[c,m]=a.useState(!1),[x,f]=a.useState(null),{login:b}=ue(),j=l();ve("Iniciar Sesi√≥n");return V.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:V.jsx("div",{className:"max-w-md w-full",children:V.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[V.jsxs("div",{className:"text-center mb-8",children:[V.jsx("div",{className:"inline-flex items-center justify-center mb-3",children:V.jsx("div",{className:"bg-gray-900 rounded-2xl p-3 shadow-lg",children:V.jsx("div",{className:"text-white text-xl font-bold tracking-widest",style:{fontFamily:"Arial, sans-serif",letterSpacing:"0.3em"},children:"KOAJ"})})}),V.jsx("div",{className:"mb-3",children:V.jsx("p",{className:"text-lg font-semibold text-blue-600",children:"Puerto Carre√±o"})}),V.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sistema de Cierre de Caja y Arqueo Diario"}),V.jsx("p",{className:"text-gray-600",children:"Inicia sesi√≥n para acceder al sistema"})]}),n&&V.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[V.jsx(u,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),V.jsx("p",{className:"text-sm text-red-800",children:n})]}),x&&V.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[V.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin flex-shrink-0 mt-0.5"}),V.jsxs("div",{className:"flex-1",children:[V.jsx("p",{className:"text-sm font-medium text-blue-900",children:x.message}),x.isWaiting&&V.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"El servidor est√° iniciando, por favor espera..."})]})]}),V.jsxs("form",{onSubmit:async t=>{t.preventDefault(),o(""),d(!0),f(null);try{const t=await b(e,s,e=>{f(e)});t.success?j("/"):o(t.error||"Error al iniciar sesi√≥n")}catch(a){o("Error al iniciar sesi√≥n. Por favor intenta de nuevo.")}finally{d(!1),f(null)}},className:"space-y-6",children:[V.jsxs("div",{children:[V.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electr√≥nico"}),V.jsx("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none",placeholder:"usuario@ejemplo.com",disabled:i})]}),V.jsxs("div",{children:[V.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrase√±a"}),V.jsxs("div",{className:"relative",children:[V.jsx("input",{id:"password",type:c?"text":"password",value:s,onChange:e=>r(e.target.value),required:!0,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all outline-none",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",disabled:i}),V.jsx("button",{type:"button",onClick:()=>m(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors focus:outline-none",disabled:i,tabIndex:-1,children:c?V.jsx(h,{className:"w-5 h-5"}):V.jsx(p,{className:"w-5 h-5"})})]})]}),V.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Iniciando sesi√≥n..."]}):V.jsxs(V.Fragment,{children:[V.jsx(g,{className:"w-5 h-5"}),"Iniciar sesi√≥n"]})})]}),V.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:V.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Sistema de Gesti√≥n de Cierre de Caja v5.0"})})]})})})},Ne=()=>{const e=l(),t=he();return ve("Acceso Denegado"),V.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 flex items-center justify-center p-4",children:V.jsx("div",{className:"max-w-md w-full",children:V.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[V.jsx("div",{className:"flex justify-center mb-6",children:V.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:V.jsx(f,{className:"w-12 h-12 text-red-600"})})}),V.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-3",children:"Acceso Denegado"}),V.jsx("p",{className:"text-gray-600 text-center mb-2",children:"No tienes permisos para acceder a esta secci√≥n del sistema."}),t&&V.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[V.jsxs("p",{className:"text-sm text-gray-700 text-center",children:[V.jsx("span",{className:"font-medium",children:"Usuario:"})," ",t.name||t.email]}),V.jsxs("p",{className:"text-sm text-gray-700 text-center mt-1",children:[V.jsx("span",{className:"font-medium",children:"Rol:"})," ",V.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"admin"===t.role?"Administrador":"sales"===t.role?"Ventas":t.role})]})]}),V.jsx("p",{className:"text-sm text-gray-500 text-center mb-6",children:"Si crees que esto es un error, contacta al administrador del sistema."}),V.jsxs("div",{className:"space-y-3",children:[V.jsxs("button",{onClick:()=>e(-1),className:"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[V.jsx(b,{className:"w-5 h-5"}),"Volver Atr√°s"]}),V.jsxs("button",{onClick:()=>e("/dashboard"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[V.jsx(j,{className:"w-5 h-5"}),"Ir al Dashboard"]})]}),V.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:V.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Sistema de Gesti√≥n de Cierre de Caja"})})]})})})},Se=()=>{const e=(new Date).toLocaleString("en-US",{timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return new Date(e)},Ee=()=>{const e=Se();return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},$e=()=>{const e=Se();return`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`},ke=()=>{const e=Se();return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}-05:00`},_e=e=>{const[t,a,s]=e.split("-").map(Number);return new Date(t,a-1,s).toLocaleDateString("es-CO",{day:"2-digit",month:"long",year:"numeric"})},De=({children:e})=>{const t=l(),s=i(),{user:r,logout:n}=ue(),[o,d]=a.useState($e()),{dailySales:c,monthlySales:m,inventoryTotal:u,billsOpenTotal:x,loadingInventory:h,loadingBills:p,dailyComparison:g,monthlyComparison:f,nextDayLastYear:b,previousDay:A,fullMonthLastYear:L,loading:R}=(()=>{const[e,t]=a.useState({dailySales:null,monthlySales:null,inventoryTotal:null,billsOpenTotal:null,loadingInventory:!0,loadingBills:!0,dailyComparison:null,monthlyComparison:null,nextDayLastYear:null,previousDay:null,fullMonthLastYear:null,loading:!0,error:null}),s=async()=>{try{const e=Ee(),a=Se(),s=new Date(a);s.setFullYear(a.getFullYear()-1);const r=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),o=`${r}-${n}-${String(s.getDate()).padStart(2,"0")}`,l=new Date(s);l.setDate(l.getDate()+1);const i=l.getFullYear(),d=`${i}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`,c=new Date(a);c.setDate(c.getDate()-1);const m=c.getFullYear(),u=`${m}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`,x=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-01`,h=`${r}-${n}-01`,p=new Date(r,parseInt(n),0),g=`${r}-${n}-${String(p.getDate()).padStart(2,"0")}`;Q.info("üìä Obteniendo estad√≠sticas de ventas (optimizado - grupos secuenciales)",{today:e,yesterday:u,todayLastYear:o,nextDayLastYear:d,startOfMonth:x,startOfMonthLastYear:h,endOfMonthLastYear:g}),Q.info("üîÑ Grupo 1: Obteniendo datos actuales (d√≠a y mes)...");const[f,b]=await Promise.all([oe(`/api/sales/quick-summary?from=${e}&to=${e}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null),oe(`/api/sales/quick-summary?from=${x}&to=${e}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null)]);Q.info("‚úÖ Grupo 1 completado"),Q.info("üì¶ Lanzando petici√≥n de inventario (as√≠ncrono)..."),oe(`/api/inventory/quick-total?to_date=${e}`,{method:"GET"}).then(async e=>{if(e.ok){const a=await e.json();t(e=>({...e,inventoryTotal:{value:(null==a?void 0:a.total_value)||0,valueFormatted:null==a?void 0:a.total_value_formatted,toDate:null==a?void 0:a.to_date},loadingInventory:!1})),Q.info("‚úÖ Inventario total actualizado:",null==a?void 0:a.total_value_formatted)}else t(e=>({...e,inventoryTotal:null,loadingInventory:!1})),Q.error("‚ùå Error obteniendo inventario total")}).catch(e=>{t(e=>({...e,inventoryTotal:null,loadingInventory:!1})),Q.error("‚ùå Error en petici√≥n de inventario:",e)}),Q.info("üí≥ Lanzando petici√≥n de cuentas por pagar (as√≠ncrono)..."),oe(`/api/bills/open-totals?from_date=${x}&to_date=${e}`,{method:"GET"}).then(async e=>{if(e.ok){const a=await e.json();t(e=>({...e,billsOpenTotal:{amount:(null==a?void 0:a.missing_amount)||0,amountFormatted:null==a?void 0:a.missing_amount_formatted,totalDocuments:(null==a?void 0:a.total_documents)||0,fromDate:null==a?void 0:a.from_date,toDate:null==a?void 0:a.to_date},loadingBills:!1})),Q.info("‚úÖ Cuentas por pagar actualizadas:",null==a?void 0:a.missing_amount_formatted)}else t(e=>({...e,billsOpenTotal:null,loadingBills:!1})),Q.error("‚ùå Error obteniendo cuentas por pagar")}).catch(e=>{t(e=>({...e,billsOpenTotal:null,loadingBills:!1})),Q.error("‚ùå Error en petici√≥n de cuentas por pagar:",e)}),Q.info("üîÑ Grupo 2: Obteniendo datos a√±o anterior y d√≠a anterior (comparaci√≥n)..."),Q.info(`üìÖ Petici√≥n d√≠a siguiente a√±o anterior: /api/sales/quick-summary?from=${d}&to=${d}`),Q.info(`üìÖ Petici√≥n d√≠a anterior (ayer): /api/sales/quick-summary?from=${u}&to=${u}`),Q.info(`üìÖ Petici√≥n mes COMPLETO a√±o anterior (para meta): /api/sales/quick-summary?from=${h}&to=${g}`);const[j,y,v,w,N]=await Promise.all([oe(`/api/sales/quick-summary?from=${o}&to=${o}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null),oe(`/api/sales/quick-summary?from=${d}&to=${d}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null),oe(`/api/sales/quick-summary?from=${u}&to=${u}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null),oe(`/api/sales/quick-summary?from=${h}&to=${o}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null),oe(`/api/sales/quick-summary?from=${h}&to=${g}`,{method:"GET"}).then(e=>e.ok?e.json():null).catch(()=>null)]);Q.info("‚úÖ Grupo 2 completado");const S=(null==f?void 0:f.total_sales)||0,E=(null==j?void 0:j.total_sales)||0,$=S-E,k=E>0?(S-E)/E*100:S>0?100:0,_=(null==b?void 0:b.total_sales)||0,D=(null==w?void 0:w.total_sales)||0,C=_-D,T=D>0?(_-D)/D*100:_>0?100:0,O=(null==N?void 0:N.total_sales)||0,P=(null==y?void 0:y.total_sales)||0;Q.info("üìÖ D√≠a siguiente del a√±o anterior:",{fecha:d,respuesta:y,total:P});const I=(null==v?void 0:v.total_sales)||0;Q.info("üìÖ D√≠a anterior (ayer):",{fecha:u,respuesta:v,total:I});const A=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);t(t=>({...t,dailySales:S,monthlySales:_,dailyComparison:{current:{date:e,total:S,formatted:A(S)},previous:{date:o,total:E,formatted:A(E)},difference:$,differenceFormatted:A(Math.abs($)),percentageChange:Math.round(100*k)/100,isGrowth:$>=0},monthlyComparison:{current:{period:`${x} a ${e}`,total:_,formatted:A(_)},previous:{period:`${h} a ${o}`,total:D,formatted:A(D)},difference:C,differenceFormatted:A(Math.abs(C)),percentageChange:Math.round(100*T)/100,isGrowth:C>=0},nextDayLastYear:{date:d,total:P,formatted:A(P)},previousDay:{date:u,total:I,formatted:A(I)},fullMonthLastYear:{period:`${h} a ${g}`,total:O,formatted:A(O)},loading:!1,error:null})),Q.info("‚úÖ Comparaci√≥n a√±o sobre a√±o actualizada")}catch(e){Q.error("Error al obtener comparaci√≥n a√±o sobre a√±o",e),t(t=>({...t,loading:!1,error:e.message}))}};return a.useEffect(()=>{s();const e=setInterval(()=>{s()},78e4);return()=>clearInterval(e)},[]),e})(),[M,F]=a.useState(!1),[z,G]=a.useState(!1),q=a.useRef(null),U=a.useRef(null),Y=e=>null==e?"Cargando...":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);a.useEffect(()=>{const e=setInterval(()=>{d($e())},1e3);return()=>clearInterval(e)},[]),a.useEffect(()=>{const e=e=>{q.current&&!q.current.contains(e.target)&&F(!1),U.current&&!U.current.contains(e.target)&&G(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const B=[{id:"ventas-totales",label:"Totales de Ventas",description:"Ventas agrupadas por d√≠a/mes",path:"/estadisticas-avanzadas/ventas-totales",icon:v,color:"purple",roles:["admin"]},{id:"documentos-venta",label:"Documentos de Venta",description:"Facturas detalladas",path:"/estadisticas-avanzadas/documentos",icon:w,color:"blue",roles:["admin"]},{id:"analytics",label:"Analytics Avanzado",description:"An√°lisis inteligente de ventas",path:"/estadisticas-estandar/analytics",icon:N,color:"orange",roles:["admin"]},{id:"productos",label:"An√°lisis de Productos",description:"Reportes desde Alegra",path:"/estadisticas-estandar/productos",icon:y,color:"green",roles:["admin"]},{id:"inventario",label:"An√°lisis de Inventario",description:"Estado del inventario",path:"/estadisticas-estandar/inventario",icon:S,color:"teal",roles:["admin"]}],W=[{id:"dashboard",label:"Cierre de Caja",path:"/dashboard",icon:j,color:"blue",roles:["admin","sales"]},{id:"monthly-sales",label:"Ventas Mensuales",path:"/monthly-sales",icon:y,color:"purple",roles:["sales"]}].filter(e=>xe(e.roles)),J=B.filter(e=>xe(e.roles)),K=e=>s.pathname===e||s.pathname.startsWith(e+"/"),H=e=>{t(e),G(!1)};return V.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[V.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:V.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:V.jsxs("div",{className:"flex items-center justify-between h-16",children:[V.jsxs("div",{className:"flex items-center gap-4",children:[V.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center shadow-md",children:V.jsx(N,{className:"w-6 h-6 text-white"})}),V.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm",children:[V.jsx("span",{className:"font-semibold text-gray-900",children:"Sistema KOAJ"}),V.jsx(E,{className:"w-4 h-4 text-gray-400"}),V.jsx("span",{className:"text-gray-600",children:"Puerto Carre√±o"})]})]}),V.jsxs("div",{className:"flex items-center gap-6",children:[V.jsxs("nav",{className:"hidden lg:flex items-center gap-1",children:[W.map(e=>{const t=e.icon,a=K(e.path),s={blue:{bg:"bg-blue-50",icon:"text-blue-600"},purple:{bg:"bg-purple-50",icon:"text-purple-600"}},r=s[e.color]||s.blue;return V.jsxs("button",{onClick:()=>H(e.path),className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors "+(a?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[V.jsx("div",{className:`w-7 h-7 ${r.bg} rounded-lg flex items-center justify-center`,children:V.jsx(t,{className:`w-4 h-4 ${r.icon}`})}),e.label]},e.id)}),xe(["admin"])&&J.length>0&&V.jsxs("div",{ref:U,className:"relative",children:[V.jsxs("button",{onClick:()=>G(!z),className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors "+(z||s.pathname.includes("/estadisticas")?"bg-indigo-50 text-indigo-700":"text-gray-700 hover:bg-gray-100"),children:[V.jsx("div",{className:"w-7 h-7 bg-indigo-50 rounded-lg flex items-center justify-center",children:V.jsx(N,{className:"w-4 h-4 text-indigo-600"})}),"Estad√≠sticas",V.jsx($,{className:"w-4 h-4 transition-transform "+(z?"rotate-180":"")})]}),z&&V.jsx("div",{className:"absolute top-full right-0 mt-2 w-72 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50",children:J.map(e=>{const t=e.icon,a={purple:{icon:"text-purple-600",bg:"bg-purple-50",hover:"hover:bg-purple-100"},blue:{icon:"text-blue-600",bg:"bg-blue-50",hover:"hover:bg-blue-100"},orange:{icon:"text-orange-600",bg:"bg-orange-50",hover:"hover:bg-orange-100"},green:{icon:"text-green-600",bg:"bg-green-50",hover:"hover:bg-green-100"},teal:{icon:"text-teal-600",bg:"bg-teal-50",hover:"hover:bg-teal-100"}},s=a[e.color]||a.blue;return V.jsxs("button",{onClick:()=>H(e.path),className:`w-full text-left px-3 py-2.5 ${s.hover} transition-colors flex items-start gap-3`,children:[V.jsx("div",{className:`w-8 h-8 ${s.bg} rounded-lg flex items-center justify-center flex-shrink-0`,children:V.jsx(t,{className:`w-4 h-4 ${s.icon}`})}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.label}),V.jsx("div",{className:"text-xs text-gray-500 leading-tight",children:e.description})]})]},e.id)})})]}),V.jsxs("a",{href:re()?`${X[0]}/api/docs`:`${ee}/api/docs`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors",children:[V.jsx("div",{className:"w-7 h-7 bg-teal-50 rounded-lg flex items-center justify-center",children:V.jsx(k,{className:"w-4 h-4 text-teal-600"})}),"Docs"]})]}),V.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm text-gray-600",children:[V.jsx("div",{className:"w-7 h-7 bg-slate-50 rounded-lg flex items-center justify-center",children:V.jsx(_,{className:"w-4 h-4 text-slate-600"})}),V.jsx("span",{className:"font-medium",children:o})]}),V.jsxs("div",{ref:q,className:"relative",children:[V.jsxs("button",{onClick:()=>F(!M),className:"flex items-center gap-2 hover:bg-gray-50 rounded-lg px-3 py-2 transition-colors",children:[V.jsx("div",{className:"w-8 h-8 bg-violet-50 rounded-lg flex items-center justify-center",children:V.jsx(D,{className:"w-5 h-5 text-violet-600"})}),V.jsxs("div",{className:"hidden md:block text-left",children:[V.jsx("p",{className:"text-sm font-medium text-gray-900",children:(null==r?void 0:r.name)||(null==r?void 0:r.email)||"Admin"}),V.jsx("p",{className:"text-xs text-gray-500",children:"admin"===(null==r?void 0:r.role)?"Administrador":"Ventas"})]}),V.jsx($,{className:"w-4 h-4 text-gray-400 transition-transform "+(M?"rotate-180":"")})]}),M&&V.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50",children:[V.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[V.jsx("p",{className:"text-sm font-medium text-gray-900",children:(null==r?void 0:r.name)||(null==r?void 0:r.email)||"Administrador KOAJ"}),V.jsx("p",{className:"text-xs text-gray-500",children:null==r?void 0:r.email})]}),V.jsxs("button",{onClick:()=>{n(),t("/login")},className:"w-full text-left px-4 py-2.5 hover:bg-red-50 transition-colors flex items-center gap-3 text-red-600",children:[V.jsx(C,{className:"w-4 h-4"}),V.jsx("span",{className:"text-sm font-medium",children:"Cerrar Sesi√≥n"})]})]})]})]})]})})}),K("/dashboard")&&V.jsx("div",{className:"bg-gray-50 border-b border-gray-200",children:V.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[V.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow p-6",children:V.jsxs("div",{className:"flex items-start gap-4",children:[V.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center shadow-sm",children:V.jsx(T,{className:"w-7 h-7 text-white"})}),V.jsxs("div",{className:"flex-1",children:[V.jsx("h3",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Venta del D√≠a"}),R?V.jsx("div",{className:"flex items-center justify-center py-8",children:V.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[V.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),V.jsx("span",{className:"text-sm",children:"Cargando..."})]})}):V.jsxs("div",{className:"space-y-4",children:[V.jsx("div",{children:V.jsx("p",{className:"text-4xl font-bold text-gray-900 leading-none",children:Y(c)})}),g&&g.previous&&g.previous.total>0&&(()=>{const e=1.25*g.previous.total,t=c/e*100,a=c>=e,s=Math.max(0,e-c);return V.jsxs("div",{className:"p-3 rounded-lg border "+(a?"bg-emerald-50 border-emerald-200":"bg-amber-50 border-amber-200"),children:[V.jsxs("div",{className:"flex items-center justify-between mb-2",children:[V.jsxs("div",{className:"flex items-center gap-1.5",children:[a?V.jsx(O,{className:"w-4 h-4 text-emerald-600"}):V.jsx(P,{className:"w-4 h-4 text-amber-600"}),V.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Meta Diaria (+25%)"})]}),a&&V.jsx("span",{className:"px-1.5 py-0.5 bg-emerald-100 text-emerald-700 text-[10px] font-bold rounded",children:"CUMPLIDA"})]}),V.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[V.jsx("span",{className:"text-gray-600",children:"Meta:"}),V.jsx("span",{className:"font-bold text-gray-800",children:Y(e)})]}),V.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:V.jsx("div",{className:"h-full rounded-full transition-all "+(a?"bg-emerald-500":"bg-amber-500"),style:{width:`${Math.min(100,t)}%`}})}),V.jsxs("div",{className:"flex justify-between mt-1 text-[10px]",children:[V.jsxs("span",{className:"text-gray-500",children:[Math.round(t),"%"]}),!a&&s>0&&V.jsxs("span",{className:"text-amber-700 font-medium",children:["Falta: ",Y(s)]})]})]})})(),V.jsxs("div",{className:"pt-3 mt-3 border-t border-gray-100 space-y-3",children:[g&&g.previous&&V.jsxs("div",{className:"flex items-center justify-between text-xs",children:[V.jsxs("span",{className:"text-gray-500",children:["Venta ",g.previous.date]}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("span",{className:"font-medium text-gray-700",children:g.previous.formatted}),(()=>{const e=g.previous.total||0,t=c||0,a=e>0?(t-e)/e*100:t>0?100:0,s=a>=0;return V.jsxs("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold "+(s?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[s?"‚Üë":"‚Üì"," ",Math.abs(Math.round(100*a)/100),"%"]})})()]})]}),b&&b.date&&V.jsxs("div",{className:"flex items-center justify-between text-xs",children:[V.jsxs("span",{className:"text-gray-500",children:["Venta ",b.date]}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("span",{className:"font-medium text-gray-700",children:b.formatted}),(()=>{const e=b.total||0,t=c||0,a=e>0?(t-e)/e*100:t>0?100:0,s=a>=0;return V.jsxs("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold "+(s?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[s?"‚Üë":"‚Üì"," ",Math.abs(Math.round(100*a)/100),"%"]})})()]})]})]})]})]})]})}),V.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow p-6",children:V.jsxs("div",{className:"flex items-start gap-4",children:[V.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-sm",children:V.jsx(I,{className:"w-7 h-7 text-white"})}),V.jsxs("div",{className:"flex-1",children:[V.jsx("h3",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Venta del Mes"}),R?V.jsx("div",{className:"flex items-center justify-center py-8",children:V.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[V.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),V.jsx("span",{className:"text-sm",children:"Cargando..."})]})}):V.jsxs("div",{className:"space-y-2",children:[V.jsx("div",{children:V.jsx("p",{className:"text-4xl font-bold text-gray-900 leading-none",children:Y(m)})}),L&&L.total>0&&(()=>{const e=1.25*L.total,t=m/e*100,a=m>=e,s=Math.max(0,e-m);return V.jsxs("div",{className:"p-3 rounded-lg border "+(a?"bg-emerald-50 border-emerald-200":"bg-blue-50 border-blue-200"),children:[V.jsxs("div",{className:"flex items-center justify-between mb-2",children:[V.jsxs("div",{className:"flex items-center gap-1.5",children:[a?V.jsx(O,{className:"w-4 h-4 text-emerald-600"}):V.jsx(P,{className:"w-4 h-4 text-blue-600"}),V.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Meta Mensual (+25%)"})]}),a&&V.jsx("span",{className:"px-1.5 py-0.5 bg-emerald-100 text-emerald-700 text-[10px] font-bold rounded",children:"CUMPLIDA"})]}),V.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[V.jsx("span",{className:"text-gray-600",children:"Meta:"}),V.jsx("span",{className:"font-bold text-gray-800",children:Y(e)})]}),V.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:V.jsx("div",{className:"h-full rounded-full transition-all "+(a?"bg-emerald-500":"bg-blue-500"),style:{width:`${Math.min(100,t)}%`}})}),V.jsxs("div",{className:"flex justify-between mt-1 text-[10px]",children:[V.jsxs("span",{className:"text-gray-500",children:[Math.round(t),"%"]}),!a&&s>0&&V.jsxs("span",{className:"text-blue-700 font-medium",children:["Falta: ",Y(s)]})]})]})})(),f&&f.previous&&V.jsx("div",{className:"pt-2 mt-2 border-t border-gray-100",children:V.jsxs("div",{className:"flex items-center justify-between text-xs",children:[V.jsx("span",{className:"text-gray-500",children:(()=>{const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],t=f.previous.period,a=t.split("-");if(a.length>=2){const t=a[0],s=e[parseInt(a[1],10)-1]||"";return s?`${s} ${t}`:t}return t})()}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("span",{className:"font-medium text-gray-700",children:f.previous.formatted}),V.jsxs("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-semibold "+(f.isGrowth?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[f.isGrowth?"‚Üë":"‚Üì"," ",Math.abs(f.percentageChange),"%"]})]})]})}),V.jsx("div",{className:"pt-2 mt-2 border-t border-gray-100",children:V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide font-medium",children:"Inventario Total"}),h?V.jsx("div",{className:"flex items-center gap-1.5",children:V.jsx("div",{className:"w-3 h-3 border-2 border-purple-300 border-t-purple-600 rounded-full animate-spin"})}):u?V.jsx("span",{className:"text-sm font-bold text-purple-700",children:u.valueFormatted||Y(u.value)}):V.jsx("div",{className:"flex items-center gap-1.5",children:V.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-gray-500 rounded-full animate-spin"})})]})}),V.jsx("div",{className:"pt-2 mt-2 border-t border-gray-100",children:V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500 uppercase tracking-wide font-medium",children:"Cuentas Por Pagar"}),p?V.jsx("div",{className:"flex items-center gap-1.5",children:V.jsx("div",{className:"w-3 h-3 border-2 border-red-300 border-t-red-600 rounded-full animate-spin"})}):x?V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("span",{className:"text-sm font-bold text-red-700",children:x.amountFormatted||Y(x.amount)}),x.totalDocuments>0&&V.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:[x.totalDocuments," doc."]})]}):V.jsx("div",{className:"flex items-center gap-1.5",children:V.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-gray-500 rounded-full animate-spin"})})]})})]})]})]})})]})})}),V.jsx("main",{className:"flex-1",children:V.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})}),V.jsx("footer",{className:"bg-white border-t border-gray-200 mt-auto",children:V.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:V.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2",children:[V.jsxs("p",{className:"text-sm text-gray-600",children:["¬© ",(new Date).getFullYear()," Sistema de Gesti√≥n KOAJ. Todos los derechos reservados."]}),V.jsx("p",{className:"text-xs text-gray-500",children:"Versi√≥n 2.0 | Desarrollado con ‚ù§Ô∏è"})]})})})]})},Ce=a.lazy(()=>J(()=>import("./Dashboard-KXwYAqai.js").then(e=>e.D),__vite__mapDeps([0,1,2,3]))),Te=a.lazy(()=>J(()=>import("./MonthlySales-8yp_4yGK.js"),__vite__mapDeps([4,1,2,3]))),Oe=a.lazy(()=>J(()=>import("./ProductosLayout-CjpXdKNc.js"),__vite__mapDeps([5,1,3]))),Pe=a.lazy(()=>J(()=>import("./AnalyticsLayout-Y4qXQsCi.js"),__vite__mapDeps([6,1,3]))),Ie=a.lazy(()=>J(()=>import("./UnifiedInventoryAnalysis-75KBNkG-.js"),__vite__mapDeps([7,1,8,3]))),Ae=a.lazy(()=>J(()=>import("./DirectStatsDashboard-Bx3Q6lW2.js"),__vite__mapDeps([9,1,8,3,10,11]))),Le=a.lazy(()=>J(()=>import("./DirectSalesTotals-5jHI5EeE.js"),__vite__mapDeps([10,1,8,3]))),Re=a.lazy(()=>J(()=>import("./DirectSalesDocuments-BK7JlquZ.js"),__vite__mapDeps([11,1,8,3]))),Me=()=>V.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:V.jsxs("div",{className:"text-center",children:[V.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),V.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando..."})]})}),Fe=()=>V.jsx(ye,{children:V.jsx(me,{children:V.jsx(d,{children:V.jsx(a.Suspense,{fallback:V.jsx(Me,{}),children:V.jsxs(c,{children:[V.jsx(m,{path:"/login",element:V.jsx(we,{})}),V.jsx(m,{path:"/unauthorized",element:V.jsx(Ne,{})}),V.jsx(m,{path:"/dashboard",element:V.jsx(pe,{allowedRoles:["admin","sales"],children:V.jsx(De,{children:V.jsx(Ce,{})})})}),V.jsx(m,{path:"/monthly-sales",element:V.jsx(pe,{allowedRoles:["admin","sales"],children:V.jsx(De,{children:V.jsx(Te,{})})})}),V.jsx(m,{path:"/estadisticas-avanzadas",element:V.jsx(pe,{allowedRoles:["admin"],children:V.jsx(De,{children:V.jsx(Ae,{})})})}),V.jsx(m,{path:"/estadisticas-avanzadas/ventas-totales",element:V.jsx(pe,{allowedRoles:["admin"],children:V.jsx(De,{children:V.jsx(Le,{})})})}),V.jsx(m,{path:"/estadisticas-avanzadas/documentos",element:V.jsx(pe,{allowedRoles:["admin"],children:V.jsx(De,{children:V.jsx(Re,{})})})}),V.jsx(m,{path:"/estadisticas-estandar/productos",element:V.jsx(pe,{allowedRoles:["admin"],children:V.jsx(De,{children:V.jsx(Oe,{})})})}),V.jsx(m,{path:"/estadisticas-estandar/analytics",element:V.jsx(pe,{allowedRoles:["admin"],children:V.jsx(De,{children:V.jsx(Pe,{})})})}),V.jsx(m,{path:"/estadisticas-estandar/inventario",element:V.jsx(pe,{allowedRoles:["admin"],children:V.jsx(De,{children:V.jsx(Ie,{})})})}),V.jsx(m,{path:"/productos",element:V.jsx(r,{to:"/estadisticas-estandar/productos",replace:!0})}),V.jsx(m,{path:"/analytics",element:V.jsx(r,{to:"/estadisticas-estandar/analytics",replace:!0})}),V.jsx(m,{path:"/inventario",element:V.jsx(r,{to:"/estadisticas-estandar/inventario",replace:!0})}),V.jsx(m,{path:"/",element:V.jsx(r,{to:"/dashboard",replace:!0})}),V.jsx(m,{path:"*",element:V.jsx(r,{to:"/dashboard",replace:!0})})]})})})})});Y.createRoot(document.getElementById("root")).render(V.jsx(o.StrictMode,{children:V.jsx(Fe,{})}));export{J as _,ve as a,ie as b,ke as c,de as d,oe as e,_e as f,Ee as g,V as j,Q as l,le as s,ue as u};
